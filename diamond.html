<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ãƒ€ã‚¤ãƒ¤ç›¸å ´æ¤œç´¢ï¼ˆè¤‡åˆæ¡ä»¶ï¼‰</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <h1>ãƒ€ã‚¤ãƒ¤ç›¸å ´æ¤œç´¢</h1>

  <label>æœ€å°ã‚«ãƒ©ãƒƒãƒˆ:</label>
  <input type="number" id="caratMin" step="0.01" value="0.3">
  <label>æœ€å¤§ã‚«ãƒ©ãƒƒãƒˆ:</label>
  <input type="number" id="caratMax" step="0.01" value="2.0"><br><br>

  <label>ã‚«ãƒ©ãƒ¼:</label>
  <input type="text" id="color" placeholder="ä¾‹: FANCY GREEN"><br><br>

  <label>ã‚¯ãƒ©ãƒªãƒ†ã‚£:</label>
  <input type="text" id="clarity" placeholder="ä¾‹: SI1"><br><br>

  <label>å½¢çŠ¶:</label>
  <input type="text" id="shape" placeholder="ä¾‹: RD"><br><br>

  <button onclick="search()">æ¤œç´¢</button>

  <div id="result" style="margin-top:20px;"></div>

  <script>
    // ğŸ”¹ Firebase åˆæœŸåŒ–
    const firebaseConfig = {
      apiKey: "AIzaSyAh46ZVl6ICR9ynh6G8VZn6RlApcqpSq48",
      authDomain: "sgc-diamond-db.firebaseapp.com",
      projectId: "sgc-diamond-db",
      storageBucket: "sgc-diamond-db.firebasestorage.app",
      messagingSenderId: "552067864642",
      appId: "1:552067864642:web:c4cb10821bdd7b1a85f5db",
      measurementId: "G-DNMP8JJNB7"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ğŸ”¹ æ¤œç´¢é–¢æ•°
    async function search() {
      const caratMin = parseFloat(document.getElementById("caratMin").value);
      const caratMax = parseFloat(document.getElementById("caratMax").value);
      const color = document.getElementById("color").value.trim();
      const clarity = document.getElementById("clarity").value.trim();
      const shape = document.getElementById("shape").value.trim();

      let query = db.collection("diamonds")
        .where("carat", ">=", caratMin)
        .where("carat", "<=", caratMax);

      if(color) query = query.where("color", "==", color);
      if(clarity) query = query.where("clarity", "==", clarity);
      if(shape) query = query.where("shape", "==", shape);

      const snapshot = await query.get();
      const resultsDiv = document.getElementById("result");
      resultsDiv.innerHTML = "";

      if(snapshot.empty) {
        resultsDiv.innerHTML = "<p>è©²å½“ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“</p>";
        return;
      }

      snapshot.forEach(doc => {
        const data = doc.data();
        resultsDiv.innerHTML += `
          <div style="border-bottom:1px solid #ccc; margin:5px 0;">
            <strong>NO:</strong> ${data.NO} |
            <strong>ã‚«ãƒ©ãƒƒãƒˆ:</strong> ${data.carat} |
            <strong>ã‚«ãƒ©ãƒ¼:</strong> ${data.color} |
            <strong>ã‚¯ãƒ©ãƒªãƒ†ã‚£:</strong> ${data.clarity} |
            <strong>å½¢çŠ¶:</strong> ${data.shape} |
            <strong>å˜ä¾¡:</strong> ï¿¥${data.pricePerCarat}
          </div>
        `;
      });
    }
  </script>
</body>
</html>
