<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>トップページ</title>
<link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;600;700&family=Cormorant+Garamond:ital,wght@0,400;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --green:    #1A3628;
  --green-lt: #254D38;
  --green-dk: #0E1F17;
  --gold:     #C09A50;
  --gold-lt:  #E8D49A;
  --gold-dk:  #8A6A28;
  --cream:    #F7F3EB;
  --cream-dk: #EDE6D8;
  --white:    #FFFFFF;
  --ink:      #1C1A16;
  --ink-soft: #5A5448;
  --border:   rgba(192,154,80,0.18);
  --shadow:   0 4px 24px rgba(28,26,22,0.10);
  --red:      #B52929;
  --blue:     #1A5A9A;
}

html { background: var(--cream); height: 100%; }
body {
  font-family: 'DM Sans', sans-serif;
  background: var(--cream);
  color: var(--ink);
  overflow-y: auto;
  overflow-x: hidden;
  padding-bottom: 40px;
}

body::before {
  content: '';
  position: fixed; inset: 0;
  pointer-events: none; z-index: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  opacity: 0.4;
}

/* ─── Price band (at top) ─── */
.price-band {
  position: relative; z-index: 1;
  background: var(--green-dk);
  padding: 0 20px;
  border-bottom: 1px solid rgba(192,154,80,0.15);
}
.price-band::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent 0%, var(--gold-dk) 20%, var(--gold) 50%, var(--gold-dk) 80%, transparent 100%);
}
.price-band-inner {
  max-width: 560px;
  margin: 0 auto;
  padding: 22px 0 18px;
}

.price-band-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}
.price-band-title {
  font-family: 'Shippori Mincho', serif;
  font-size: 1.05rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  color: var(--white);
}
.price-detail-link {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: 0.7rem;
  letter-spacing: 0.1em;
  color: var(--gold);
  text-decoration: none;
  border: 1px solid rgba(192,154,80,0.35);
  border-radius: 100px;
  padding: 4px 12px;
  transition: background 0.18s, border-color 0.18s;
  font-family: 'DM Sans', sans-serif;
}
.price-detail-link:hover {
  background: rgba(192,154,80,0.12);
  border-color: rgba(192,154,80,0.6);
}
.price-detail-link svg { width: 11px; height: 11px; }

.price-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.price-item {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(192,154,80,0.15);
  border-radius: 12px;
  padding: 13px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}
.price-item-metal {
  font-size: 0.6rem;
  letter-spacing: 0.2em;
  color: rgba(232,212,154,0.55);
  text-transform: uppercase;
  margin-bottom: 4px;
}
.price-item-val {
  font-family: 'DM Sans', sans-serif;
  font-size: 1.3rem;
  font-weight: 500;
  color: var(--white);
  letter-spacing: 0.01em;
  line-height: 1;
}
.price-item-unit { font-size: 0.65rem; color: rgba(255,255,255,0.35); margin-left: 3px; }
.price-item-diff {
  font-size: 0.8rem;
  font-weight: 500;
  padding: 3px 9px;
  border-radius: 100px;
  white-space: nowrap;
  font-family: 'DM Sans', sans-serif;
}
.positive { background: rgba(181,41,41,0.18); color: #f08080; }
.negative { background: rgba(26,90,154,0.2);  color: #7ab0f0; }
.price-item-diff.loading { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.25); font-size: 0.7rem; }

/* Update time — more readable */
.price-update {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 6px;
  margin-top: 12px;
}
.price-update-label {
  font-size: 0.65rem;
  color: rgba(200,160,80,0.5);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-family: 'DM Sans', sans-serif;
}
.price-update-time {
  font-size: 0.78rem;
  color: rgba(255,255,255,0.45);
  letter-spacing: 0.05em;
  font-family: 'DM Sans', sans-serif;
}

/* ─── Notice ─── */
.notice-pill {
  position: relative; z-index: 1;
  display: flex;
  align-items: center;
  gap: 8px;
  background: rgba(30,61,44,0.08);
  border: 1px solid rgba(192,154,80,0.2);
  border-radius: 8px;
  padding: 9px 14px;
  margin: 16px 18px 0;
  font-size: 0.78rem;
  color: var(--gold-dk);
}
.notice-pill svg { flex-shrink: 0; }

/* ─── Quick access ─── */
.section-wrap {
  position: relative; z-index: 1;
  padding: 24px 18px 0;
}
.section-label {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.62rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: var(--gold-dk);
  margin-bottom: 12px;
}
.section-label::after {
  content: '';
  flex: 1; height: 1px;
  background: var(--border);
}

.quick-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}
.quick-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px 8px;
  cursor: pointer;
  text-decoration: none;
  color: var(--ink);
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s;
  box-shadow: var(--shadow);
  min-height: 88px;
}
.quick-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 28px rgba(28,26,22,0.14);
  border-color: rgba(192,154,80,0.4);
}
.quick-btn:active { transform: scale(0.96); }
.quick-btn-icon {
  width: 36px; height: 36px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(30,61,44,0.08);
}
.quick-btn-icon svg { width: 18px; height: 18px; }
.quick-btn-label {
  font-family: 'Shippori Mincho', serif;
  font-size: 0.78rem;
  font-weight: 600;
  text-align: center;
  color: var(--green);
  line-height: 1.3;
}

/* ─── Exhibition ─── */
.exhibition-list { display: flex; flex-direction: column; gap: 10px; }
.exhibition-card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px 16px;
  box-shadow: var(--shadow);
  display: flex;
  gap: 14px;
  align-items: flex-start;
  transition: transform 0.18s, box-shadow 0.18s;
}
.exhibition-card:hover { transform: translateY(-2px); box-shadow: 0 6px 24px rgba(28,26,22,0.12); }
.ex-dot { width: 8px; height: 8px; border-radius: 50%; margin-top: 5px; flex-shrink: 0; }
.ex-dot.today { background: var(--gold); animation: pulse-dot 2s infinite; }
.ex-dot.upcoming { background: var(--green-lt); }
@keyframes pulse-dot {
  0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(192,154,80,0.4); }
  50%       { box-shadow: 0 0 0 5px rgba(192,154,80,0); }
}
.ex-badge {
  display: inline-block;
  font-size: 0.58rem; font-weight: 600;
  letter-spacing: 0.12em; text-transform: uppercase;
  padding: 2px 8px; border-radius: 100px; margin-bottom: 5px;
}
.ex-badge.today    { background: rgba(192,154,80,0.15); color: var(--gold-dk); border: 1px solid rgba(192,154,80,0.3); }
.ex-badge.upcoming { background: rgba(30,61,44,0.08);   color: var(--green-lt); border: 1px solid rgba(30,61,44,0.15); }
.ex-title { font-family: 'Shippori Mincho', serif; font-size: 0.95rem; font-weight: 600; color: var(--ink); margin-bottom: 4px; line-height: 1.35; }
.ex-location { font-size: 0.8rem; color: var(--ink-soft); margin-bottom: 2px; }
.ex-date     { font-size: 0.72rem; color: #aaa; letter-spacing: 0.04em; }
.ex-empty    { font-size: 0.85rem; color: var(--ink-soft); font-style: italic; padding: 8px 0; }

/* ─── Update log ─── */
.update-list { display: flex; flex-direction: column; gap: 0; }
.update-item {
  display: flex; gap: 14px; align-items: baseline;
  padding: 9px 0; border-bottom: 1px solid rgba(192,154,80,0.1); font-size: 0.83rem;
}
.update-item:last-child { border-bottom: none; }
.update-date { font-size: 0.7rem; color: var(--ink-soft); white-space: nowrap; letter-spacing: 0.04em; min-width: 90px; }
.update-text { color: var(--ink); }

/* ─── Contact ─── */
.contact-box {
  background: var(--white); border: 1px solid var(--border); border-radius: 12px;
  padding: 16px 18px; box-shadow: var(--shadow); font-size: 0.85rem; color: var(--ink-soft); line-height: 1.7;
}
.contact-box a { color: var(--green); font-weight: 500; text-decoration: underline; text-underline-offset: 2px; }
.contact-box a:hover { color: var(--gold-dk); }
</style>
</head>
<body>

<!-- Price band (at top) -->
<div class="price-band">
  <div class="price-band-inner">
    <div class="price-band-header">
      <div class="price-band-title">田中貴金属 買取価格</div>
      <a class="price-detail-link" href="#" onclick="openFrame(event,'price.html')">
        詳細価格
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
      </a>
    </div>
    <div class="price-row">
      <div class="price-item">
        <div class="price-item-left">
          <div class="price-item-metal">Gold · 金</div>
          <div class="price-item-val"><span id="gold-price">—</span><span class="price-item-unit">円</span></div>
        </div>
        <div class="price-item-diff loading" id="gold-diff">読込中</div>
      </div>
      <div class="price-item">
        <div class="price-item-left">
          <div class="price-item-metal">Platinum · プラチナ</div>
          <div class="price-item-val"><span id="pt-price">—</span><span class="price-item-unit">円</span></div>
        </div>
        <div class="price-item-diff loading" id="pt-diff">読込中</div>
      </div>
    </div>
    <div class="price-update">
      <span class="price-update-label">更新日時</span>
      <span class="price-update-time" id="update-time">—</span>
    </div>
  </div>
</div>

<div class="notice-pill">
  <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
  サイドメニューからも各ページにアクセスできます
</div>

<!-- Quick Access -->
<div class="section-wrap">
  <div class="section-label">クイックアクセス</div>
  <div class="quick-grid">

    <a class="quick-btn" href="#" onclick="openFrame(event,'diamond.html')">
      <div class="quick-btn-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="#1A3628" stroke-width="2"><path d="M12 2L2 9l10 13 10-13-10-7z"/><path d="M2 9h20"/></svg>
      </div>
      <div class="quick-btn-label">ダイヤ相場検索</div>
    </a>

    <a class="quick-btn" href="#" onclick="openFrame(event,'coin.html')">
      <div class="quick-btn-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="#1A3628" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8v8M8 10h8"/></svg>
      </div>
      <div class="quick-btn-label">記念金貨買取価格</div>
    </a>

    <a class="quick-btn" href="#" onclick="openFrame(event,'https://script.google.com/macros/s/AKfycbxeQHB5lwwoTw0f-cgXh657fuaNiHL-LMbo5AfUOm9pDyftHNaF7OPi5hfMOrKNPhKYyQ/exec')">
      <div class="quick-btn-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="#1A3628" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
      </div>
      <div class="quick-btn-label">買取 / 分割確認</div>
    </a>

  </div>
</div>

<!-- Exhibition -->
<div class="section-wrap">
  <div class="section-label">開催の大黄金展</div>
  <div class="exhibition-list" id="ex-container">
    <div class="ex-empty">読み込み中…</div>
  </div>
</div>

<!-- Update log -->
<div class="section-wrap">
  <div class="section-label">更新履歴</div>
  <div class="update-list">
    <div class="update-item"><span class="update-date">2025/10/13</span><span class="update-text">ダイヤ市場相場検索ページ 公開</span></div>
    <div class="update-item"><span class="update-date">2025/10/13</span><span class="update-text">IG買取分割確認ページ 公開</span></div>
    <div class="update-item"><span class="update-date">2025/10/01</span><span class="update-text">記念金貨買取価格ページ 公開</span></div>
  </div>
</div>

<!-- Contact -->
<div class="section-wrap" style="padding-bottom: 24px;">
  <div class="section-label">問い合わせ</div>
  <div class="contact-box">
    当ポータルに関するお問い合わせは
    <a href="https://works.do/FD5CnsF" target="_blank" rel="noopener noreferrer">横森（LINE WORKS）</a>
    までお願いいたします。
  </div>
</div>

<script>
function openFrame(e, url) {
  e.preventDefault();
  const iframe = parent.document.getElementById('main-frame');
  if (iframe) iframe.src = url;
}

fetch("data/tanaka_price.json")
  .then(r => r.json())
  .then(data => {
    const g  = data.prices.GOLD;
    const pt = data.prices.PLATINUM;

    document.getElementById("gold-price").textContent = g.buy;
    document.getElementById("pt-price").textContent   = pt.buy;
    document.getElementById("update-time").textContent = data.update_time || '—';

    const gEl = document.getElementById("gold-diff");
    gEl.textContent  = g.buy_diff + " 円";
    gEl.className    = "price-item-diff " + (g.buy_diff.includes('-') ? 'negative' : 'positive');

    const ptEl = document.getElementById("pt-diff");
    ptEl.textContent = pt.buy_diff + " 円";
    ptEl.className   = "price-item-diff " + (pt.buy_diff.includes('-') ? 'negative' : 'positive');

    notifyHeight();
  })
  .catch(() => {
    document.getElementById("gold-price").textContent = "取得失敗";
    document.getElementById("pt-price").textContent   = "取得失敗";
  });

fetch("data/exhibition.json")
  .then(r => r.json())
  .then(events => {
    const todayStr = new Date().toISOString().split("T")[0];
    const gold = events.filter(e => e.category === "大黄金展");
    const todayEv    = gold.filter(e => e.start <= todayStr && e.end >= todayStr);
    const upcomingEv = gold.filter(e => e.start > todayStr)
                           .sort((a,b) => a.start.localeCompare(b.start))
                           .slice(0, 4);

    const box = document.getElementById("ex-container");
    let html = '';

    if (todayEv.length === 0 && upcomingEv.length === 0) {
      html = '<div class="ex-empty">現在・直近の開催予定はありません。</div>';
    } else {
      todayEv.forEach(e => {
        html += `<div class="exhibition-card">
          <div class="ex-dot today"></div>
          <div class="ex-body">
            <span class="ex-badge today">開催中</span>
            <div class="ex-title">${e.title}</div>
            <div class="ex-location">${e.location}</div>
            <div class="ex-date">${e.start} 〜 ${e.end}</div>
          </div>
        </div>`;
      });
      upcomingEv.forEach(e => {
        html += `<div class="exhibition-card">
          <div class="ex-dot upcoming"></div>
          <div class="ex-body">
            <span class="ex-badge upcoming">開催予定</span>
            <div class="ex-title">${e.title}</div>
            <div class="ex-location">${e.location}</div>
            <div class="ex-date">${e.start} 〜 ${e.end}</div>
          </div>
        </div>`;
      });
    }
    box.innerHTML = html;
    notifyHeight();
  })
  .catch(() => {
    document.getElementById("ex-container").innerHTML = '<div class="ex-empty">データ取得に失敗しました。</div>';
  });

function notifyHeight() {
  parent.postMessage({ type: 'resize-iframe', height: document.body.scrollHeight }, '*');
}
window.addEventListener('load', notifyHeight);
window.addEventListener('resize', notifyHeight);
</script>
</body>
</html>
